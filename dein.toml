# Usage
# @reload:call dein#recache_runtimepath()
# @lazy  :lazy = 1

[[plugins]]
repo = 't9md/vim-quickhl'
hook_add ='''
    nmap <Space>s <Plug>(quickhl-manual-this)
    nmap <Space>se <Plug>(quickhl-manual-reset)
'''

[[plugins]]
repo = 'vim-airline/vim-airline'

[[plugins]]
repo = 'vim-airline/vim-airline-themes'
hook_add ='''
    set laststatus=2
    let g:airline_powerline_fonts = 1
    let g:airline#extensions#whitespace#mixed_indent_algo = 1
    let g:airline#extensions#tabline#buffer_idx_mode = 1
    let g:airline#extensions#ale#enabled = 1
    let g:airline#extensions#ale#error_symbol = 'E:'
    let g:airline#extensions#ale#warning_symbol = 'W:'
    " let g:airline_theme = 'dracula'
    " let g:airline_theme = 'iceberg'
    let g:airline_theme = 'tomorrow'
    " let g:airline_theme = 'breezy'
    let g:airline#extensions#tabline#enabled = 1
    let g:airline#extensions#tabline#show_buffers = 0
    let g:airline#extensions#tabline#tab_nr_type = 1
    let g:airline#extensions#virtualenv#enabled = 1
    let g:airline#extensions#tabline#fnamemod = ':t'
    " let g:airline_left_sep='>'
'''

[[plugins]]
repo = 'MattesGroeger/vim-bookmarks'
hook_add ='''
    nnoremap mb :BookmarkToggle<CR>
    let g:bookmark_sign = '@'
    let g:bookmark_annotation_sign = '☰'
    let g:bookmark_highlight_lines = 1
    let g:bookmark_center = 1
'''

[[plugins]]
repo = 'Shougo/dein.vim'

[[plugins]] # カーソル位置のコンテキストに合わせてftを切り替える
repo = 'osyo-manga/vim-precious'
depends = ['context_filetype.vim']

[[plugins]] # カーソル位置のコンテキストのftを判定するライブラリ
repo = 'Shougo/context_filetype.vim'

[[plugins]] # toml syntax
repo = 'cespare/vim-toml'
on_ft = 'toml'

[[plugins]]
repo = 'Shougo/neoyank.vim'

[[plugins]]
repo = 'kassio/neoterm'
hook_add = '''
    let g:neoterm_size = 14
    let g:neoterm_autoscroll =1
    let g:neoterm_autoinsert = 1
    " terminal position
    let g:neoterm_default_mod='belowright'
    " nnoremap <silent> <C-e><C-e> :call My_TREPLSendSelection()<cr>
    " vnoremap <silent> <C-e><C-e> :TREPLSendSelection<cr>
    " nnoremap <silent> <C-e><C-e> :TREPLSendLine<cr>
    nnoremap <silent> <C-e><C-f> :call Exec_python()<cr>
    " nnoremap <silent> <C-e><C-f> :TREPLSendFile<cr>'>j0
    nnoremap <silent> ttn  :Tnew<CR>
    nnoremap <silent> ttl   :Tclear<CR>
    nnoremap <silent> tti  :Topen<cr>
    nnoremap <silent> ttc  :Tclose<cr>
    nnoremap <silent> tto  :Ttoggle<CR>
    nnoremap <silent> ttt  :call My_New_Terminal_Tab()<CR>
    nnoremap <silent> tts  :call My_New_Terminal_VSplit()<cr>
    nnoremap <silent> ttk  :Tkill<cr>
    nnoremap <silent> <F5> :T pdb %<CR><c-w>ki
    function! My_TREPLSendSelection()
        Topen
        :TREPLSendLine
    endfunction

    function! My_New_Terminal_Tab()
        " let g:neoterm_fixedsize = winfixheight
        let g:neoterm_size = winheight(0)
        tabnew
        Tnew
        let g:neoterm_size = 10
    endfunction

    function! My_New_Terminal_VSplit()
        " let g:neoterm_fixedsize = winfixheight
        let g:neoterm_size = winwidth(0) / 2
        vertical Tnew
        " wincmd h
        " call feedkeys("i")
        let g:neoterm_size = 10
    endfunction

    function! Exec_python()
        :w!
        let g:neoterm_autoinsert = 0
        Topen
        Tclear
        T python3.6  %
        let g:neoterm_autoinsert = 1
    endfunction

    if has('vim_starting')
        let &t_ti.="¥e[1 q"
        let &t_SI.="¥e[5 q"
        let &t_EI.="¥e[1 q"
        let &t_te.="¥e[0 q"
    endif

'''

[[plugins]]
repo = 'jonathanfilip/vim-lucius'

[[plugins]]
repo = 'tomasr/molokai'

[[plugins]]
repo = 'cocopon/iceberg.vim'

[[plugins]]
repo = 'jacoborus/tender.vim'

[[plugins]]
repo = 'fneu/breezy'

[[plugins]]
repo = 'Shougo/neomru.vim'

[[plugins]]
repo = 'vim-scripts/Align'
hook_add = '''
    vnoremap <Space>a :Align 
    let g:Align_xstrlen=3
'''

[[plugins]]
repo = 'majutsushi/tagbar'
lazy = 1
hook_add = '''
    " nnoremap <silent><Space>t :call MyOpenBar()<cr>
    nnoremap <silent><Space>t :TagbarOpenAutoClose<cr>
    nnoremap <silent><F8>     :TagbarToggle<cr>
    function! MyOpenBar()
        if expand("%:t") =~ ".*\.md"
            :Toc
        else
            :TagbarOpenAutoClose
        endif
    endfunction
'''
hook_source = '''
    " [Usage]
    " tag jump: p
    let g:tagbar_width = 30
    let g:tagbar_autoshowtag = 0
    let g:tagbar_expand = 1
    " let g:tagbar_left = 1
    "set statusline=%F%m%r%h%w¥%=%{tagbar#currenttag('[%s]','')}¥[Pos=%v,%l]¥[Len=%L]
'''

[[plugins]]
repo = 'vim-scripts/zoom.vim'
hook_add = '''
'''

[[plugins]]
repo = 'Lokaltog/vim-easymotion'
hook_add = '''
    " let g:EasyMotion_do_mapping = 0
    " nmap s <Plug>(easymotion-s2)
    " xmap s <Plug>(easymotion-s2)
    " omap z <Plug>(easymotion-s2)
    " nmap g/ <Plug>(easymotion-sn)
    " xmap g/ <Plug>(easymotion-sn)
    " omap g/ <Plug>(easymotion-tn)
    " let g:EasyMotion_smartcase = 1
    " map <Leader>j <Plug>(easymotion-j)
    " map <Leader>k <Plug>(easymotion-k)
    " let g:EasyMotion_startofline = 0
    " let g:EasyMotion_keys = 'QZASDFGHJKL;'
    " let g:EasyMotion_use_upper = 1
    " let g:EasyMotion_enter_jump_first = 1
    " let g:EasyMotion_space_jump_first = 1
    " hi EasyMotionTarget guifg=#80a0ff ctermfg=81
'''

[[plugins]]
repo = 'thinca/vim-quickrun'
hook_add ='''
'''

[[plugins]]
repo = '5t111111/alt-gtags.vim'
hook_add ='''
'''

[[plugins]]
repo = 'fuenor/qfixgrep'
hook_add ='''
'''

# [[plugins]]
# repo = 'fuenor/qfixhowm'
# hook_add ='''
#     let QFixHown_Key = 'g'
#     if has('win64')
#         let howm_dir = 'c:/howm'
#         let howm_fileencoding = 'cp932'
#         let howm_fileformat = 'dos'
#     else
#         let howm_dir = '/home/okada-hxf'
#         let howm_fileencoding = 'utf-8'
#         let howm_fileencoding = 'unix'
#     endif
#     let howm_filename = '%Y/%m/%Y^%m-%d-%H%M%S.txt'
#     let g:QFixHowm_WildCardChapter = 1
#     let QFixHowm_FoldingChapterTitle = 1
#     let QFixHowm_Folding = 0
#
#     nnoremap <space>a gg<S-v><S-g>
#     vnoremap <space>c "*y
#     nnoremap <space>v "*p
# '''

[[plugins]]
repo = 'junegunn/vim-easy-align'
hook_add ='''
    vnoremap <Enter> <Plug>(EasyAlign)
    nnoremap ga <Plug>(EasyAlign)
'''

[[plugins]]
repo = 'pebble8888/doxygen_comment_creator'
hook_add ='''
'''

# [[plugins]]
# repo = 'vim-scripts/gtags.vim'
# hook_add ='''
# '''

[[plugins]]
repo = 'vim-scripts/DoxygenToolkit.vim'
hook_add ='''
    noremap ,d :Dox<CR>
'''

[[plugins]]
repo = 'Shougo/neosnippet-snippets'
hook_add ='''
'''

[[plugins]]
repo = 'Shougo/neosnippet.vim'
hook_add ='''
    imap <C-k> <Plug>(neosnippet_expand_or_jump)
    smap <C-k> <Plug>(neosnippet_expand_or_jump)
    xmap <C-k> <Plug>(neosnippet_expand_target)
    let g:neosnippet#snippets_directory='~/home/aapfuser/.cache/neosnippet/my'
    " ドットでオムニ補完候補を出す
    " inoremap <expr><tab> pumvisible() ? "\<C-n>" :
    "\ neosnippet#expandable_or_jumpable() ?
    "\    "\<Plug>(neosnippet_expand_or_jump)" : "\<tab>"
    imap <expr><TAB> neosnippet#expandable_or_jumpable() ?
      \ "\<Plug>(neosnippet_expand_or_jump)"
      \: pumvisible() ? "\<C-n>" : "\<TAB>"
    smap <expr><TAB> neosnippet#expandable_or_jumpable() ?
          \ "\<Plug>(neosnippet_expand_or_jump)"
          \: "\<TAB>"
    if has('conceal')
      set conceallevel=2 concealcursor=i
endif
'''

[[plugins]]
repo = 'fuenor/qfixgrep'
hook_add ='''
'''

[[plugins]]
repo = 'vim-scripts/DoxygenToolkit.vim'
hook_add ='''
    noremap ,d :Dox<CR>
'''

[[plugins]]
repo = 'kana/vim-operator-user'
hook_add ='''
'''

[[plugins]]
repo = 'kana/vim-textobj-user'
hook_add ='''
'''

[[plugins]]
repo = 'osyo-manga/vim-textobj-multiblock'
hook_add ='''
'''

[[plugins]]
repo = 'thinca/vim-textobj-between'
hook_add ='''
'''

[[plugins]]
repo = 'rhysd/vim-textobj-anyblock'
hook_add ='''
'''

[[plugins]]
repo = 'osyo-manga/vim-operator-stay-cursor'
hook_add ='''
    map y <Plug>(operator-stay-cursor-yank)
'''

[[plugins]]
repo = 'osyo-manga/vim-operator-exec_command'
hook_add ='''
    nmap <expr> <Space>uj operator#exec_command#mapexpr(":Unite line -input=%t")
'''

[[plugins]]
repo = 'bps/vim-textobj-python'
hook_add ='''
    let g:textobj_python_no_default_key_mappings = 1
    xmap af <Plug>(textobj-python-function-a)
    omap af <Plug>(textobj-python-function-a)
    xmap if <Plug>(textobj-python-function-i)
    omap if <Plug>(textobj-python-function-i)

    xmap ac <Plug>(textobj-python-class-a)
    omap ac <Plug>(textobj-python-class-a)
    xmap ic <Plug>(textobj-python-class-i)
    omap ic <Plug>(textobj-python-class-i)

    nmap [f <Plug>(textobj-python-function-p)
    nmap ]f <Plug>(textobj-python-function-n)

    nmap [c <Plug>(textobj-python-class-p)
    nmap ]c <Plug>(textobj-python-class-n)
'''

[[plugins]]
repo = 'kana/vim-operator-replace'
hook_add ='''
map t <Plug>(operator-replace)
'''

[[plugins]]
repo = 'rhysd/vim-operator-surround'
hook_add ='''
    " nnoremap sa <Plug>(operator-surround-append-input-in-advance)
    " nnoremap s( <Plug>(operator-surround-append-input-in-advance)(
    " nnoremap sb <Plug>(operator-surround-append-input-in-advance)(
    " nnoremap s{ <Plug>(operator-surround-append-input-in-advance){
    " nnoremap s[ <Plug>(operator-surround-append-input-in-advance)[
    " nnoremap s" <Plug>(operator-surround-append-input-in-advance)"
    " nnoremap s' <Plug>(operator-surround-append-input-in-advance)'
    nmap <silent>s <Plug>(operator-surround-append)
    nmap <silent>ds <Plug>(operator-surround-delete)i
    nmap <silent>cs <Plug>(operator-surround-replace)i

    " nmap <silent>ss <Plug>(operator-surround-append)<Plug>(textobj-multiblock-a)
    " nmap <silent>ds <Plug>(operator-surround-delete)<Plug>(textobj-multiblock-a)
    " nmap <silent>cs <Plug>(operator-surround-replace)<Plug>(textobj-multiblock-a)

    "map <silent>sdd <Plug>(operator-surround-delete)<Plug>(textobj-anyblock-a)
    "map <silent>srr <Plug>(operator-surround-replace)<Plug>(textobj-anyblock-a)

    "map <silent>sdb <Plug>(operator-surround-delete)<Plug>(textobj-between-a)
    "map <silent>srb <Plug>(operator-surround-replace)<Plug>(textobj-between-a)
'''

[[plugins]]
repo = 'emonkak/vim-operator-comment'
hook_add ='''
'''

[[plugins]]
repo = 'emonkak/vim-operator-sort'
hook_add ='''
'''

[[plugins]]
repo = 'osyo-manga/vim-operator-search'
hook_add ='''
    " nmap <Space>/ <Plug>(operator-search)<cr>
    " vmap <Space>/ <Plug>(operator-search)
    " nmap <Space>; <Plug>(operator-search)if
'''

[[plugins]]
repo = 'AndrewRadev/linediff.vim'
hook_add ='''
let g:linediff_first_buffer_command = 'leftabove new'
let g:linediff_secommand_buffer_command = 'rightbelow vertical new'
vnoremap dl :Linediff<CR>
nnoremap dl :Linediff<CR>
'''

[[plugins]]
repo = 'Vimjas/vim-python-pep8-indent'
on_ft = 'python'
hook_add ='''
'''

[[plugins]]
repo = 'Shougo/denite.nvim'
hook_add ='''
    " http://replicity.hateblo.jp/entry/2017/06/03/140731
    call denite#custom#option('default', 'prompt', '>')
    call denite#custom#option('default', 'direction', 'top')
    " key mappings
    " noremap [Denite] <Nop>
    " nmap <Leader>f [Denite]

    nnoremap <silent> <Space>uo :<C-u>Denite -direction=top file_mru<CR>
    " nnoremap <silent> <Space>b :<C-u>Denite -direction=top buffer<CR>
    " nnoremap <silent> <Space>f :<C-u>DeniteBufferDir -direction=top file_rec<CR>
    " nnoremap <silent> <Space>g :<C-u>DeniteBufferDir -direction=top grep<CR>
    nnoremap <silent> <Space>i :<C-u>Denite line -direction=top<CR>
    nnoremap <silent> ,g       :<C-u>Denite grep -direction=top -no-empty -no-quit -buffer-name=search-buffer<CR>
    " nnoremap <silent> <Space>vh :<C-u>Denite help<CR>
    "nnoremap <silent> <Space>n :<C-u>Denite -resume -immediately -select=+1<CR>
    "nnoremap <silent> <Space>p :<C-u>Denite -resume -immediately -select=-1<CR>
    " nnoremap <Space>bk :<C-u>Denite -direction=topleft -cursor-wrap=true bookmark<CR>
    "nnoremap <Space>a :<C-u>DeniteBookmarkAdd<CR>
    " nnoremap <Space>c :Denite command_history<CR>
    " ウィンドウを分割して開く
    call denite#custom#map('_', "<C-h>", '<denite:do_action:split>')
    call denite#custom#map('insert', "<C-h>", '<denite:do_action:split>')
    " ウィンドウを縦に分割して開く
    call denite#custom#map('_', "<C-v>", '<denite:do_action:vsplit>')
    call denite#custom#map('insert', "<C-v>", '<denite:do_action:vsplit>')
    " ウィンドウをタブで開く
    call denite#custom#map('normal', "t", '<denite:do_action:tabswitch>')
    call denite#custom#map('insert', "<c-t>", '<denite:do_action:tabswitch>')
    call denite#custom#map('normal', "l", '<denite:do_action:default>')
    " インサート→ノーマルモード
    call denite#custom#map('insert', "jj", '<denite:enter_mode:normal>')
    call denite#custom#map('insert', "<c-c>", '<denite:quit>')

    if executable('rg')
        " コマンド．file_rec で使うコマンド
        " call denite#custom#var('file_rec', 'command', ['rg', '--files', '--glob', '!.git'])
        " コマンド．grep で使うコマンド
        call denite#custom#var('grep', 'command', ['rg'])
        "call denite#custom#var('grep', 'recursive_opts', )
        "call denite#custom#var('grep', 'final_opts', )
        call denite#custom#var('grep', 'separator', ['--'])
        call denite#custom#var('grep', 'default_opts', ['--vimgrep', '--no-heading'])
    endif

    ".git以下のディレクトリ検索
    " nnoremap <silent> <Space>gf :<C-u>Denite -direction=topleft -cursor-wrap=true
    "      \ -path=`substitute(finddir('.git', './;'), '.git', '', 'g')`
    "      \ file_rec/git<CR>
    " call denite#custom#source('file'    , 'matchers', ['matcher_cpsm', 'matcher_fuzzy'])
    call denite#custom#source('file'    , 'matchers', ['matcher_substring'])
    call denite#custom#source('buffer'  , 'matchers', ['matcher_substring'])
    call denite#custom#source('file_mru', 'matchers', ['matcher_substring'])
    call denite#custom#source('file_rec', 'matchers', ['matcher_substring'])
    call denite#custom#alias('source', 'file_rec/git', 'file_rec')
    call denite#custom#var('file_rec/git', 'command',
      \ ['git', 'ls-files', '-co', '--exclude-standard'])
'''

[[plugins]]
repo = 'Shougo/deoplete.nvim'
if = 'has("nvim")'
on_i = 1
hook_source = '''
    let g:deoplete#enable_at_startup = 1
    let g:deoplete#auto_complete_delay = 0
    " let g:deoplete#auto_complete_start_length = 1
    " let g:deoplete#enable_camel_case = 0
    " let g:deoplete#enable_ignore_case = 0
    let g:deoplete#enable_refresh_always = 0
    " let g:deoplete#enable_smart_case = 1
    " let g:deoplete#file#enable_buffer_path = 1
    " let g:deoplete#max_list = 10000
    let g:deoplete#omni_patterns = {
       \ 'python': '[^. *\t]\.\w*',
       \}
'''

[[plugins]]
repo = 'prabirshrestha/vim-lsp'
hook_add = '''
'''

[[plugins]]
repo = 'lighttiger2505/deoplete-vim-lsp'
hook_source = '''
    if (executable('pyls'))
        let s:pyls_path = fnamemodify(g:python_host_prog, ':h') . '/'. 'pyls'
        augroup LspPython
            autocmd!
            autocmd User lsp_setup call lsp#register_server({
          \ 'name': 'pyls',
          \ 'cmd': {server_info->['pyls']},
          \ 'whitelist': ['python']
          \ })
        augroup END
    endif
'''

# [[plugins]]
# repo = 'zchee/deoplete-jedi'
# on_ft = 'python'
# hook_source = '''
#     " let g:deoplete#sources#jedi#python_path = substitute(system('which python3.6'), "¥n", "", "")
# '''

# [[plugins]]
# repo = 'davidhalter/jedi-vim'
# on_ft = 'python'
# # lazy=1
# # hook_add = '''
# hook_source = '''
#         let g:jedi#auto_initialization = 1
#         let g:jedi#auto_vim_configuration = 1
#
#         "# 補完キーの設定この場合???Ctrl+Space
#         let g:jedi#completions_command = "<C-Space>"
#         "# 変数の宣言場所へジャンプ???Ctrl + g)
#         " let g:jedi#goto_assignments_command = "<C-g>"
#         "# クラス???関数定義にジャンプ???Gtrl + d???
#         " let g:jedi#goto_definitions_command = "<C-j>"
#         nnoremap <C-j><C-j> :call jedi#goto_definitions()<cr>
#         nnoremap <C-j>s :call Jedi_my_setting_sp()<cr>
#         nnoremap <C-j>t :call Jedi_my_setting_tab()<cr>
#         function! Jedi_my_setting_sp()
#             :vs
#             :call jedi#goto_definitions()
#         endfunction
#         function! Jedi_my_setting_tab()
#             :tab sp
#             :call jedi#goto_definitions()
#         endfunction
#         "# Pydocを表示???Ctrl + k???
#         " let g:jedi#documentation_command = "<C-k>"
#         let g:jedi#usages_command = "<C-k>"
#         let g:jedi#popup_select_first = 0
#         " let g:jedi#popup_on_dot = 0
#         let g:jedi#show_call_signatures = 1
#         let g:jedi#show_call_signatures_delay = 10
#
#         " nnoremap <silent><C-n> :cnext<cr>
#         " nnoremap <silent><C-p> :cprev<cr>
# '''

[[plugins]]
repo = 'iyuuya/denite-ale'

[[plugins]]
repo = 'w0rp/ale'
hook_add = '''
    " Installation: pip3.6 install flake8 flake8-import-order autopep8 black isort
    let g:ale_enabled = 0
    let g:ale_sign_error = '>>'
    let g:ale_sign_warning = '??'
    " let g:ale_lint_on_save = 1
    let g:ale_lint_on_text_changed = 0
    let g:ale_statusline_format = ['x %d', '? %d', 'o ok']
    let g:ale_linters = { 
                \   'python3.6': ['flake8'],
                \   'markdown': ['alex'],
                \   'javascript': ['eslint'],
                \   'JSON': ['jq']
                \}
    let g:ale_fixers = {
    \ 'python': ['autopep8', 'black', 'isort'],
    \ }

    nmap [ale] <Nop>
    map <c-a> [ale]
    nmap <silent> [a <Plug>(ale_previous)
    nmap <silent> ]a <Plug>(ale_next)
    nmap <silent> [ale]<c-f> <Plug>(ale_fix)

    highlight clear ALEErrorSign
    highlight clear ALEWarningSign
'''

[[plugins]]
repo = 'tpope/vim-dispatch'

[[plugins]]
repo = 'janko-m/vim-test'
depends = ['vim-dispatch']
hook_add = '''
    let g:test#strategy = 'dispatch'
'''

[[plugins]]
repo = 'aliev/vim-compiler-python'

[[plugins]]
repo = 'hellosputnik/vim-plugin'
hook_add = '''
    " let g:kite_auto_complete=0
    " let g:kite_tab_complete=1
    " set completeopt-=menu
    " set completeopt+=menuone
    " set completeopt-=longest
    " set completeopt-=preview
    " set completeopt+=noinsert
    " set completeopt-=noselect
    " set completeopt+=preview
    " autocmd CompleteDone * if !pumvisible() | pclose | endif
    " set belloff+=ctrlg
    " nmap <silent> <buffer> gK <Plug>(kite-hover)
    " let g:kite_documentation_continual=1
    " let g:kite_preview_code=1
    " let g:kite_override_sign_column_highlight=0
    " set statusline=%<%f¥ %h%m%r%{kite#statusline()}%=%-14.(%l,%c%V%)¥ %P
    " set laststatus=2
'''

[[plugins]]
repo = 'neovim/python-client'

# [[plugins]]
# repo = 'lighttiger2505/gtags.vim'
# hook_add = '''
#     " Options
#     let g:Gtags_Auto_Map = 0
#     let g:Gtags_OpenQuickfixWindow = 1
#     " Keymap
#     " Show definetion of function cousor word on quickfix
#     nmap <silent> K :<C-u>exe("Gtags ".expand('<cword>'))<CR>
#     " Show reference of cousor word on quickfix
#     nmap <silent> R :<C-u>exe("Gtags -r ".expand('<cword>'))<CR>
# '''

[[plugins]]
repo = 'ozelentok/denite-gtags'
on_ft = 'python'
hook_add = '''
    " autocmd FileType python call s:denite_gtags_settings()
    " function! s:denite_gtags_settings() abort
    "     nmap <C-j> :DeniteCursorWord -buffer-name=gtags_def gtags_def<cr>
    "     nmap <C-h> :DeniteCursorWord -buffer-name=gtags_ref gtags_ref<cr>
    " endfunction
'''

# [[plugins]]
# repo = 'jsfaint/gen_tags.vim'
# hook_add = '''
#     let g:gen_tags#gtags_auto_gen = 1
# '''

[[plugins]]
repo = 'tyru/caw.vim.git'
hook_add ='''
    nmap cc <Plug>(caw:hatpos:toggle)
    vmap cc <Plug>(caw:hatpos:toggle)
'''

[[plugins]]
repo = 'dracula/vim'

# [[plugins]]
# repo = 'scrooloose/nerdtree'
# hook_add ='''
#     " autocmd vimenter * NERDTree
#     nnoremap <F7> :NERDTreeToggle<cr>
#     let g:NERDTreeDirArrows = 1
#     let g:NERDTreeDirArrowExpandable  = '▶'
#     let g:NERDTreeDirArrowCollapsible = '▼'
#     let g:NERDTreeMapUpdir = "h"
#     " let g:NERDTreeMapPreviewSplit = "h"
#     let g:NERDTreeMapOpenVSplit = "v"
#     let g:NERDTreeMapPreviewVSplit = "<C-v>"
#     let g:NERDTreeMapOpenInTabSilent = "<C-t>"
#     let g:NERDTreeMapActivateNode = "l"
# '''

[[plugins]]
repo = 'xolox/vim-misc'
hook_add ='''
'''

[[plugins]]
repo = 'xolox/vim-session'
depends = ['xolox/vim-misc']
hook_add ='''
    nnoremap <F10> :SaveSession 
    nnoremap <silent> <F11> :OpenSession<CR>

    " 現在のディレクトリ直下の .vimsessions/ を取得
    let s:local_session_directory = '~/.config/nvim/sessions'
    " session保存ディレクトリをそのディレクトリの設定
    " let g:session_directory = s:local_session_directory
    let g:session_directory = "~/.cache/dein/repos/github.com/xolox"
    " vim終了時に自動保存
    let g:session_autosave = 'yes'
    " 引数なしでvimを起動した時にsession保存ディレクトリのdefault.vimを開く
    "let g:session_autoload = 'yes'
    " 5分間に1回自動保存
    " let g:session_autosave_periodic = 5
    unlet s:local_session_directory
    let g:session_autoload = 'no'
'''

# [[plugins]]
# repo = 'mattn/sonictemplate-vim'
# hook_add ='''
#     let g:sonictemplate_vim_template_dir = [
#           \ '~/.config/nvim/template'
#           \]
# '''

[[plugins]]
repo = 'nathanaelkane/vim-indent-guides'
on_ft = 'python'
hook_add ='''
    nnoremap <C-h> :IndentGuidesToggle<cr>
    let g:indent_guides_enable_on_vim_startup = 1
'''

[[plugins]]
repo = 'tweekmonster/braceless.vim'
on_ft = ['python', 'cpp']
hook_add ='''
    " autocmd FileType python BracelessEnable +fold +highlight
    autocmd FileType cpp BracelessEnable +fold +highlight
    let g:braceless_jump_prev_key = '['
    let g:braceless_jump_next_key = ']'
    let g:braceless_segment_prev_key = 'k'
    let g:braceless_segment_next_key = 'j'
'''

[[plugins]]
repo = 'alfredodeza/pytest.vim'
on_ft = 'python'
hook_add ='''
    " function! Pytest_session()
    "     :Pytest file
    "     :Pytest session
    " endfunction
    nnoremap <silent> tps :Pytest session<cr>
    nnoremap <silent> tpj :call My_python_file()<cr>
    nnoremap <silent> tpc :Pytest class<cr>
    nnoremap <silent> tpf :Pytest function -s -vv<cr>
    nnoremap <silent> tpe :Pytest fails<cr>
    nnoremap <silent> tpn :Pytest next<cr>
    nnoremap <silent> tpp :Pytest previous<cr>
    nnoremap <silent> tpd :Pytest file --pdb<cr>
    nnoremap <silent> tpo :call Create_pytest_file()<cr>
    function! My_python_file()
        :w
        :Pytest file -s -vv
    endfunction
    function! Create_pytest_file()
        :tabedit ‾/hiroomi.py
    endfunction

'''

[[plugins]]
repo = 'osyo-manga/vim-over' 
hook_add ='''
    nnoremap <silent> <S-s> :OverCommandLine<CR>%s///g<Left><Left><Left> 
    vnoremap <silent> <S-s> :OverCommandLine<CR>%s///g<Left><Left><Left> 
'''

[[plugins]]
repo = 'Shougo/unite.vim' 
depends = ['vimproc.vim']
hook_add ='''
    " nnoremap <Space>d :<C-u>Unite -default-action=vimfiler directory directory_mru<cr>
    " autocmd FileType unite nmap <silent><buffer><Space> <NOP>
    autocmd FileType unite nmap <silent><buffer><expr> f unite#do_action('vimfiler')

    let g:vimfiler_as_default_explorer=1
    let g:unite_enable_start_insert=1
    nnoremap <silent> <Space>ub :<C-u>Unite buffer<CR>
    nnoremap <silent> <Space>uf :<C-u>UniteWithBufferDir -buffer-name=files file<CR>
    " nnoremap <silent> <Space>uf :<C-u>Unite file_rec<CR>
    " nnoremap <silent> <Space>o  :<C-u>Unite file_mru<CR>
    nnoremap <silent> <Space>bk :<C-u>Unite vim_bookmarks<CR>
    nnoremap <silent> <Space>uu :<C-u>Unite buffer file_mru<CR>
    nnoremap <silent> <Space>y :<C-u>Unite history/yank<CR>
    nnoremap <silent> <Space>bb  :<C-u>Unite -default-action=vimfiler bookmark<CR>
    nnoremap <silent> <Space>bf  :<C-u>Unite buffer<CR>
    " nnoremap <silent> <Space>r  :<C-u>Unite vimfiler/history<CR>
    " nnoremap <silent> <Space>r  :<C-u>UniteResume search-buffer<CR>
    nnoremap <silent> ,ug       :<C-u>Unite grep:. -no-empty -no-quit -buffer-name=search-buffer<CR>
    " nnoremap <silent> <Space>m  :<C-u>UniteResume search-buffer<CR>
    " nnoremap <silent> <Space>ul :<C-u>Unite line<CR>
    nnoremap <silent> <Space>uc :<C-u>Unite -auto-preview colorscheme<CR>
    " nnoremap <silent> <Space>gf :<C-u>Unite file_rec/async:!<CR>
    "nnoremap <silent> <Space>d :<C-u>UniteWithBufferDir -buffer-name=files buffer file_mru bookmark file<CR>
    "au FileType unite nnoremap <silent> <buffer> <expr> <C-h> unite#do_action('split')
    "au FileType unite inoremap <silent> <buffer> <expr> <C-h> unite#do_action('split')
    au FileType unite nnoremap <silent> <buffer> <expr> <C-v> unite#do_action('vsplit')
    au FileType unite nnoremap <silent> <buffer> <expr> l unite#do_action('default')
    "au FileType unite inoremap <silent> <buffer> <expr> <C-v> unite#do_action('vsplit')
    au FileType unite nnoremap <silent> <buffer> <expr> t unite#do_action('tabswitch')
    au FileType unite inoremap <silent> <buffer> <expr> <c-t> unite#do_action('tabswitch')
    au FileType unite inoremap <silent> <buffer> <expr> <c-c> <Plug> (unite_exit)
    au FileType unite nnoremap <silent> <buffer> <ESC><ESC> q
    au FileType unite inoremap <silent> <buffer> <ESC><ESC> <ESC>q

    
    inoremap <buffer> <jj> <Plug> (unite_insert_leave)
    " nnoremap <silent> <buffer> <expr> <C-q> <Plug> (unite_exit)
    " inoremap <silent> <buffer> <expr> <C-q> <Plug> (unite_exit)

    " autocmd FileType unite nmap <silent><buffer><expr> f unite#do_action('vimfiler')
    " let g:unite_source_find_default_opts = '-type d'

    if executable('rg')
        let g:unite_source_grep_command = 'rg'
        let g:unite_source_grep_recursive_opt = '' 
    endif
'''

[[plugins]]
repo = 'ujihisa/unite-colorscheme' 
depends = 'unite.vim'
hook_add ='''
'''

[[plugins]]
repo = 'Shougo/vimproc.vim' 
build = 'make'
on_source = ['vimfiler.vim']

[[plugins]]
repo = 'Shougo/vimfiler.vim' 
depends = 'unite.vim'
hook_add ='''
    let g:vimfiler_max_directories_history = 120
    " autocmd VimEnter * VimFilerBufferDir -split -simple -no-quit -winwidth=30 -toggle -no-focus -auto-cd
    nnoremap <silent> <Space>e :VimFilerBufferDir -split -simple -no-quit -winwidth=30 -toggle -auto-cd<cr>
    function! Vimfiler_mysplit()
        wincmd l
        vsplit
        wincmd h
        call feedkeys("ls")
    endfunction

    autocmd FileType vimfiler call s:vimfiler_my_settings()
    function! s:vimfiler_my_settings() abort
        map <silent><buffer><Space> <NOP>
        map <silent><buffer><C-j> <NOP>
        map <silent><buffer>v <NOP>
        " File open is cr
        " nmap <silent><buffer><expr> <cr> vimfiler#smart_cursor_map("¥<Plug>(vimfiler_cd_file)", "¥<Plug>(vimfiler_open_file_in_another_vimfiler)")
        " nmap <buffer><silent> <Space>o <Plug>(vimfiler_switch_to_history_directory)
        " nmap <buffer><silent> <C-v> :call Vimfiler_mysplit()<cr>
        nmap <silent><buffer> ? :help vimfiler-default-key-mappings<cr>
        nmap <silent><buffer><expr> <C-v> vimfiler#do_switch_action('vsplit')
        nmap <silent><buffer><expr> <C-h> vimfiler#do_switch_action('split')
        nmap <silent><buffer><expr> <C-t> vimfiler#do_switch_action('tabswitch')
        nmap <silent><buffer> <C-m> <Plug>(vimfiler_toggle_mark_current_line)
        " nmap <silent><buffer> <Space>f <Plug>(vimfiler_find)
        nmap <silent><buffer> ,g <Plug>(vimfiler_grep)
        " nmap <silent><buffer><silent> <C-k> vimfiler#do_action('vsplit')
    endfunction
'''

[[plugins]]
repo = 'tpope/vim-fugitive' 
hook_add ='''
    " Usage:
    "   * reference other branch file in current branch.
    "       :Gvsplit origin/other_branch:filename.hoge
    "       :Gedit other_branch:%
    "   * cancel modification before commit.
    "       :Gread
    "   * git add
    "       :Gwrite
    " Usage: 3-way diff :Gstatus -> D -> :diffget //2 |diffup -> :diffget //3 |diffup -> ]c -> :only
    " nnoremap <silent> <Space>vb :Gblame<cr>
    nnoremap <silent> <Space>gd :Gdiff<cr>
    nnoremap <silent> <Space>vs :Gstatus<cr>
    nnoremap <silent> <Space>vl :Glog<cr>
    " nnoremap <silent> <Space>gr :Gread<cr>
    nnoremap <Space>ge :Gvdiff :%<left><left>
    nnoremap <Space>gp :Gpull 
    nnoremap <Space>gss :Gstatus<cr>
    nnoremap <Space>gg :call My_Ggrep()<cr>
    nnoremap <Space>gj :call My_Cursor_Under_Ggrep()<cr>
    nnoremap <Space>gcc :Gcommit -m ""<left>
    nnoremap <Space>gca :Gcommit -amend<cr>
    " nnoremap <Space>gr :Gvsplit :<left><left>
    nnoremap gst :Git stash save ""<left>
    nnoremap <silent> gss :Git stash list<cr>
    nnoremap gsa :Git stash apply stash@{}<left>
    " function! My_Cursor_Under_Ggrep()
    "     :Gcd
    "     call feedkeys("yiw")
    "     call feedkeys(",ug")
    "     call feedkeys("\<Space>p")
    "     call feedkeys("\<cr>")
    " endfunction
    " function! My_Ggrep()
    "     :Gcd
    "     call feedkeys(",ug")
    " endfunction
'''

[[plugins]]
repo = 'mzlogin/vim-markdown-toc' 
hook_add ='''
'''

[[plugins]]
repo = 'kmnk/vim-unite-giti' 
hook_add ='''
    " Usage: branch switch -> giti/branch new -> switch(`git branch -b`)
    nnoremap <silent> <Space>gb  :<C-u>Unite giti/branch_all<CR>
    " nnoremap <silent> <Space>gc  :<C-u>Unite giti/config<CR>
    " nnoremap <silent> <Space>gl  :<C-u>Unite giti/log<CR>
    nnoremap <silent> <Space>gl  :Gitv<CR>
    nnoremap <silent> <Space>gL  :Gitv!<CR>
    " nnoremap <silent> <Space>gr  :<C-u>Unite giti/remote<CR>
    nnoremap <silent> <Space>gsu  :<C-u>Unite giti/status<CR>
    " nnoremap <silent> <Space>gg  :<C-u>Unite giti/grep<CR>
'''

[[plugins]]
repo = 'airblade/vim-gitgutter' 
hook_add ='''
'''

[[plugins]]
repo = 'gregsexton/gitv' 
hook_add ='''
    " Usage: Frequently cmd
    " ------------------------
    " > https://wonderwall.hatenablog.com/entry/2016/03/26/211710
    "
    " * ファイルごとのdiffを確認する場合
    "   :Gitv! -> D (diff) # compare file(between HEAD and select commit)
    " * ログからdiffを確認する場合(一覧)
    "   :Gitv  -> Enter -> zM
    "   :Gitv  -> Enter -> Enter on target file
    nnoremap <Space>gh :GitGutterLineHighlightsToggle<cr>
    nmap ]g <Plug>GitGutterNextHunk
    nmap [g <Plug>GitGutterPrevHunk
    nmap <Space>gha <Plug>GitGutterStageHunk
    nmap <Space>ghu <Plug>GitGutterUndoHunk
    nmap <Space>ghp <Plug>GitGutterPreviewHunk

    autocmd FileType git call s:gitv_my_settings()
    function! s:gitv_my_settings()
        " set statusline+=%{fugitive#statusline()}
        setlocal foldlevel=99
        nmap <silent><buffer> t O
        nmap <silent><buffer> v s
    endfunction
'''

[[plugins]]
repo = 'plytophogy/vim-virtualenv' 
hook_add ='''
    nnoremap <F7> :VirtualEnvActivate 
    nnoremap <F6> :VirtualEnvDeactivate<cr>
'''

[[plugins]]
repo = 'simeji/winresizer' 
hook_add ='''
    let g:winresizer_start_key = 'mr'
    let g:winresizer_keycode_cancel = 'c'
'''

[[plugins]]
repo = 'vim-scripts/DrawIt' 
hook_add ='''
'''

[[plugins]]
repo = 'gyim/vim-boxdraw' 
hook_add ='''
    nnoremap dm :DrawIt
    nnoremap ds :DrawIt!
'''

[[plugins]]
repo = 'Shougo/deol.nvim' 
hook_add ='''
'''

[[plugins]]
repo = 'mattn/webapi-vim' 
hook_add ='''
" > <https://www.key-p.com/blog/staff/archives/20732>
nnoremap <silent><F4> :call MyFeed()<cr>

function! MyFeed()
    tabnew
    let result = webapi#feed#parseURL("http://sampo-03.asou.nec.co.jp:50080/dashboard/projects.atom?rss_token=-jHpUfyr4qgdP4AkgNBe")
    let count = 0
    let lines = []
    for item in result
        let str = join(["[ ]", item.date, item.title, item.content, item.link], ' :')
        call append(count, str)
        call add(lines, str)
        let count += 1
        " echo keys(item)
    endfor
    let outputfile = "~/.cache/dein/repos/github.com/mattn/save.txt"
    execute ":w!" .outputfile
    " call setfperm(outputfile, "rw-rw-rw-")
    " call writefile(lines, outputfile, "a")
endfunction
'''

[[plugins]]
repo = 'plasticboy/vim-markdown' 
on_ft = 'markdown'
hook_add ='''
    let g:vim_markdown_toc_autofit = 1
    " let g:vim_markdown_folding_disabled = 1
'''

[[plugins]]
repo = 'kannokanno/previm' 
on_ft = ['markdown', 'rst']
hook_add ='''
'''

[[plugins]]
repo = 'tyru/open-browser.vim' 
on_ft = ['markdown', 'rst']
hook_add ='''
'''

[[plugins]]
repo = 'vim-scripts/DirDiff.vim' 
hook_add ='''
'''

[[plugins]]
repo = 'godlygeek/tabular' 
hook_add ='''
'''

[[plugins]]
repo = 'LeafCage/yankround.vim' 
hook_add ='''
    let g:yankround_max_history = 35
    nmap p <Plug>(yankround-p)
    nmap P <Plug>(yankround-P)
    nmap gp <Plug>(yankround-gp)
    nmap gP <Plug>(yankround-gP)
    nmap <C-p> <Plug>(yankround-prev)
    nmap <C-n> <Plug>(yankround-next)
'''

[[plugins]]
repo = 'mhinz/neovim-remote' 
hook_add ='''
    " Installation: pip3 install neovim-remote
    " Usage: README.md
'''

[[plugins]]
repo = 'honza/vim-snippets' 
hook_add ='''
'''

[[plugins]]
repo = 'SirVer/ultisnips' 
hook_add ='''
    let g:UltiSnipsExpandTrigger="<tab>"
    let g:UltiSnipsJumpForwardTrigger="<tab>"
    let g:UltiSnipsJumpBackwardTrigger="<c-z>"

    " If you want :UltiSnipsEdit to split your window.
    let g:UltiSnipsEditSplit="vertical"
'''

[[plugins]]
repo = 'dhruvasagar/vim-table-mode'
hook_add ='''
    nnoremap <c-t> :TableModeToggle<cr>
    let g:table_mode_corner='|'
'''

[[plugins]]
repo = 'billyvg/tigris.nvim'
on_ft = ['javascript', 'javascript.jsx']
hook_post_update = '''
  let g:dein#plugin.build = './install.sh'
'''
hook_add ='''
    let g:tigris#enabled = 1
    let g:tigris#on_the_fly_enabled = 1
    let g:tigris#delay = 300
'''

[[plugins]]
repo = 'autozimu/LanguageClient-neovim'
rev = 'next'
depends = ['deoplete.nvim']
build = 'bash install.sh'
hook_add = '''
    " Installation: pip install python-language-server
    set hidden
    " imap <expr> . pumvisible() ? "\<C-E>.\<C-X>\<C-O>\<C-P>" : ".\<C-X>\<C-O>\<C-P>"
    let language_client_python_path = join([substitute(system('which python3.6'), "python3.6\n", "", ""), "pyls"], '/')
    " let g:LanguageClient_hasSnippetSupport = 0
    " set completefunc=LanguageClient#complete
    let g:LanguageClient_serverCommands = {
        \ 'python': [language_client_python_path],
        "\ 'vim': ['vim-language-server', '--stdio'],
        \ }
    " nnoremap <silent> gdi :call LanguageClient#textDocument_implementation()<CR>
    " nnoremap <silent> gdf :call LanguageClient#textDocument_formatting()<CR>
    nnoremap <F5> :call LanguageClient_contextMenu()<CR>
    nnoremap <silent> <c-j>k :call LanguageClient#textDocument_hover()<CR>
    nnoremap <c-j><c-j> :call LanguageClient#textDocument_definition()<CR>
    nnoremap <c-j>v :call LC_operation('vs')<cr>
    nnoremap <c-j>s :call LC_operation('split')<cr>
    nnoremap <c-j>t :call LC_operation('tab')<cr>
    " nnoremap <silent> <F2> :call LanguageClient#textDocument_rename()<CR>
    nnoremap <silent> <c-j>r :call LanguageClient#textDocument_references()<cr>

    fu! LC_operation(operation)
        if a:operation == 'vs'
            vs
        elseif a:operation == 'split'
            split
        else
            tab sp
        endif
        call LanguageClient#textDocument_definition()
    endfu
'''

[[plugins]]
repo = 'ryanoasis/vim-devicons'
hook_add ='''
'''

[[plugins]]
repo = 'szkny/SplitTerm'
hook_add ='''
'''

[[plugins]]
repo = 'szkny/Ipython'
on_ft = 'python'
hook_add ='''
    nnoremap  <silent> <c-e><c-e> :IpythonLine<CR>
    nnoremap  <silent> <c-e><c-f> :IpythonRun<CR>
    vnoremap  <silent> <c-e><c-e> :VIpython<CR>
    nnoremap  <silent> <c-e>i :IpythonInspection<CR>

    " nnoremap <c-e>i :call setline(".", "inspect.getmembers(".getline('.').")")<cr>

    " ipythonコマンドのコマンドライン引数
	let g:ipython_startup_options = ['--no-confirm-exit']

	" ipython起動時実行するコマンドリスト
	let g:ipython_startup_command = [
				"\' from pylab import *',
				\'import pandas as pd',
				\'import numpy as np',
				\'import inspect',
				\'pd.options.display.max_rows = 10',
				\'pd.options.display.max_columns = 10',
				\'pd.options.display.precision = 3']

	" ウィンドウ幅 ( 0 にすると自動で設定)
	let g:ipython_window_width = 0
'''

[[plugins]]
repo = 'nelstrom/vim-visual-star-search'
hook_add ='''
'''

[[plugins]]
repo = 'thaerkh/vim-workspace'
hook_add ='''
'''

[[plugins]]
repo = 'junegunn/fzf'
build = './install --all'

[[plugins]]
repo = 'junegunn/fzf.vim'
hook_add ='''
    autocmd! FileType fzf nnoremap <buffer> <silent> q :q<cr>
    let $FZF_DEFAULT_OPTS = '--reverse'
    let g:fzf_layout = { 
     \ 'up': '~30%' }

    let g:fzf_action = {
        \ 'ctrl-t': 'tab split',
        \ 'ctrl-s': 'split',
        \ 'ctrl-v': 'vsplit',
        \ 'ctrl-m': 'cd',
        \ 'ctrl-l': 'e' }

    " nmap <Space>f <plug>(fzf-maps-n)
    " xmap <Space>f <plug>(fzf-maps-x)
    " omap <Space>f <plug>(fzf-maps-o)
    nnoremap <Space>ff :Rgf<cr>
    nnoremap <Space>fh :Files ~/<cr>
    nnoremap <Space>gf :GFiles<cr>
    " nnoremap <Space>gss :GFiles?<cr>
    nnoremap <Space>bl :BLines<cr>
    nnoremap <Space>gg :call My_Ggrep()<cr>
    nnoremap <Space>o :History<cr>
    nnoremap <Space>vh :Helptags<cr>
    nnoremap <Space>dd :Directorys<cr>
    nnoremap <Space>dh :DirectorysOnHome<cr>
    nnoremap <Space>fg :FilesRepository<cr>
    nnoremap <Space>gr :Repos<cr>
    nnoremap <Space>gj :call My_Ggrep()<cr>
    vnoremap <Space>gj :<c-u>Rg <c-r>0<cr>

    command! -bang -nargs=? Directorys
      "\ call fzf#run(fzf#wrap({'source': 'find -type d', 'up': '30%'}))
      \ call fzf#run({'source': 'find -type d', 'sink': 'e', 'up': '30%'})

    command! -bang -nargs=? FilesRepository
      "\ call fzf#run(fzf#wrap({'source': 'cd; find -type d', 'up': '30%'}))
      \ call fzf#run({'source': 'cd $(ghq root); find -type d', 'sink': 'e', 'up': '30%'})

    command! -bang -nargs=? DirectorysOnHome
      "\ call fzf#run(fzf#wrap({'source': 'cd; find -type d', 'up': '30%'}))
      \ call fzf#run({'source': 'cd; find -type d', 'sink': 'e', 'up': '30%'})

    command! -bang -nargs=0 Repos
      \ call fzf#run(fzf#wrap({'source': 'ghq list -p', 'up': '30%'}))

    command! -bang -nargs=? -complete=dir Files
      \ call fzf#vim#files(<q-args>, fzf#vim#with_preview(), <bang>0)

    command! -bang -nargs=0 Rgf
      \ call fzf#run(fzf#wrap({'source': 'rg --files', 'up': '30%'}))

    command! -bang -nargs=* Rg
      \ call fzf#vim#grep(
      \   'rg --line-number --no-heading '.shellescape(<q-args>), 0,
      \   fzf#vim#with_preview({'options': '--exact --reverse'}, 'right:50%:wrap'))

    function! My_Cursor_Under_Ggrep()
        if exists('Gcd')
            Gcd
        endif
        call fzf#vim#grep(
          \   'rg --line-number --no-heading '.expand('<cword>'), 0,
          \   fzf#vim#with_preview({'options': '--exact --reverse'}, 'right:50%:wrap'))
    endfunction

    function! My_Ggrep()
        if exists('Gcd')
            Gcd
        endif
        Rg
    endfunction
'''
[[plugins]]
repo = 'skanehira/translate.vim'
hook_add = '''
    " Reqiurement: installed go lang
    let g:translate_source = "en"
    let g:translate_target = "ja"
    let g:translate_winsize = 10
'''


[[plugins]]
repo = 'tpope/vim-scriptease'
hook_add = '''
    " Usage:
    " :Breakadd
    " <target command>
    " >echom <variable name>
    nnoremap <silent> <Space>vb :call MybreakToggle()<cr>

    fu! MybreakToggle()
        if !exists('g:bp_idx')
            let g:bp_idx = 0
        endif
    
        let file_name = expand('%:p')
        if file_name == ""
            return
        endif
    
        let line_nr = line('.')
        let break_point_dict = MybreakReferenceOnBuffer(file_name)
        if has_key(break_point_dict, printf('%d', line_nr))
            let sign_id = break_point_dict[line_nr]
            call Mybreakdel(file_name, sign_id)
            return
        endif
        call Mybreakadd(file_name, line_nr)
    endfu
    
    fu! Mybreakadd(file_name, line_nr)
        sign define breakpoint text=B texthl=ZenSpace
        let name = 'breakpoint'
        let g:bp_idx += 1
        let g:line_dict = {a:line_nr: g:bp_idx}
    
        " add sign
        exe "sign place ". g:bp_idx ." line=" . a:line_nr ." name=". name ." file=" . a:file_name
        breakadd here
    endfu
    
    fu! Mybreakdel(file_name, sign_id)
        exe "sign unplace ". a:sign_id ." file=". a:file_name
        breakdel here
    endfu
    
    fu! MybreakReferenceOnBuffer(file_name)
        let sign_raw = MyRedirToVariable("sign place file=" . a:file_name)
        let sign_infos = split(sign_raw, '\n')
    
        let break_point_dict = {} "line_nr: sign_id
        for sign_info in sign_infos
            let result = matchlist(sign_info, 'line=\(\d\+\)\W\+id=\(\d\+\)\W\+name=breakpoint\c')
            if len(result) <# 1
                continue
            endif
            let break_point_dict[result[1]] = result[2]
        endfor
        return break_point_dict
    endfu
    
    fu! MyRedirToVariable(cmd)
        redir => output
        silent exe a:cmd
        redir END
        return output
    endfu
'''

[[plugins]]
repo = 'szymonmaszke/vimpyter'
hook_add ='''
    autocmd Filetype ipynb nmap <silent><Space>jb :VimpyterInsertPythonBlock<CR>
    autocmd Filetype ipynb nmap <silent><Space>jj :VimpyterStartJupyter<CR>
    autocmd Filetype ipynb nmap <silent><Space>jn :VimpyterStartNteract<CR>
'''
